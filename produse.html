<!doctype html>
<html lang="ro">
<head>
  <meta charset="UTF-8" /><!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1917183292564267');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1917183292564267&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Produse â€” MSA Handmade</title>

  <!-- SEO -->
  <meta name="description" content="LumÃ¢nÄƒri È™i decoraÈ›iuni MSA Handmade â€“ produse din cearÄƒ È™i ipsos. DescoperÄƒ coroniÈ›e, lumÃ¢nÄƒri È™i decoruri.">
  <link rel="canonical" href="https://www.msahandmade.ro/produse.html">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.msahandmade.ro/produse.html">
  <meta property="og:title" content="Produse â€” MSA Handmade">
  <meta property="og:description" content="DescoperÄƒ colecÈ›ia noastrÄƒ de lumÃ¢nÄƒri È™i decoraÈ›iuni.">
  <meta property="og:image" content="https://www.msahandmade.ro/logo.png">

  <link rel="stylesheet" href="styles.css" />

  <!-- Stil extra: nav + zÄƒpadÄƒ + carduri (nu Ã®nlocuieÈ™te styles.css) -->
  <style>
    :root{ --brand:#0a2230; --gold:#ffd27a; }

    /* Banner promo */
    .promo{background:#0f3a2e;color:#fff;text-align:center;padding:10px 12px;font-weight:800}
    .promo b{color:#ffd27a}

    /* Header compact */
    .header{position:sticky;top:0;z-index:20;background:#fff;border-bottom:1px solid #eee}
    #main-nav{max-width:1100px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;gap:18px}
    #main-nav a{font-weight:700;color:#133;text-decoration:none}
    #main-nav a:hover{color:#d12b4a}
    .spacer{flex:1}
    .cart-pill{display:inline-flex;align-items:center;gap:8px;background:#f5f5f5;padding:8px 12px;border-radius:999px;font-weight:800}
    .badge{min-width:22px;height:22px;border-radius:999px;display:inline-grid;place-items:center;background:#ffe4a4;color:#000;font-weight:800}

    /* Fundal cu zÄƒpadÄƒ uÈ™oarÄƒ */
    body{background:linear-gradient(180deg,#f5ecf7 0%, #e3f0ff 100%)}
    .snow,.snow2{position:fixed;inset:0;pointer-events:none;z-index:1;opacity:.55}
    .snow{
      background-image:
        radial-gradient(#fff 1.2px, transparent 1.2px),
        radial-gradient(#fff 1.2px, transparent 1.2px),
        radial-gradient(#fff 1.2px, transparent 1.2px);
      background-size:28px 28px,36px 36px,48px 48px;
      background-position:0 0,10px -10px,-10px 20px;
      animation:snowFall 22s linear infinite;
    }
    .snow2{
      background-image:
        radial-gradient(#fff 2.2px, transparent 2.2px),
        radial-gradient(#fff 1.8px, transparent 1.8px);
      background-size:70px 70px,90px 90px;
      background-position:0 0,20px -20px;
      animation:snowFall2 14s linear infinite; opacity:.65;
    }
    @keyframes snowFall{to{background-position:0 1100px,10px 1090px,-10px 1120px}}
    @keyframes snowFall2{to{background-position:0 1200px,20px 1180px}}

    /* Container principal */
    .wrap{max-width:1100px;margin:0 auto;padding:0 16px;position:relative;z-index:2}
    h1{margin:18px 0 10px}

    /* GrilÄƒ carduri produse (dacÄƒ vrei sÄƒ foloseÈ™ti) */
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
    .card{grid-column:span 12;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.06);overflow:hidden}
    @media(min-width:720px){.card{grid-column:span 6}}
    @media(min-width:1024px){.card{grid-column:span 4}}
    .thumb{width:100%;aspect-ratio:4/3;object-fit:cover;display:block;cursor:pointer;background:#fff}

    .body{padding:12px 14px}
    .top{display:flex;justify-content:space-between;align-items:center;gap:10px}
    .price{font-weight:700}
    .desc{font-size:.92rem;color:#555;margin-top:6px;min-height:48px}

    /* Sugestii cÄƒutare */
    .search-wrap{position:relative;margin:10px 0 20px}
    .search-input{width:100%;padding:12px 14px;border:1px solid #ddd;border-radius:12px;font-size:16px}
    .suggest{position:absolute;top:46px;left:0;right:0;background:#fff;border:1px solid #ddd;border-top:none;border-radius:0 0 12px 12px;box-shadow:0 12px 24px rgba(0,0,0,.06);z-index:30;overflow:hidden}
    .suggest.hidden{display:none}
    .suggest-item{padding:10px 14px;border-top:1px solid #f0f0f0;cursor:pointer}
    .suggest-item:hover{background:#f6faff}

    /* Modal produs â€“ un singur sistem stabil */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
    .modal.open{display:flex}
    .modal-card{background:#fff;border-radius:14px;max-width:950px;width:100%;display:grid;grid-template-columns:1fr;overflow:hidden}
    @media(min-width:800px){.modal-card{grid-template-columns:1.1fr 1fr}}
    .modal-media{background:#fff;display:grid;place-items:center;padding:14px}
    .modal-media img{max-width:100%;max-height:70vh;object-fit:contain;border-radius:8px}
    .modal-body{padding:16px}
    .modal-title{font-weight:800;font-size:1.2rem;margin-bottom:8px}
    .muted{color:#555}
    .modal-top{display:flex;justify-content:space-between;align-items:start;gap:8px}
    .modal-close{background:#f4f4f4;border:0;border-radius:10px;padding:8px 10px;font-weight:700;cursor:pointer}
    .btn.primary{background:#0f3a2e;color:#fff;border:0;border-radius:12px;padding:10px 14px;font-weight:800;cursor:pointer}
    .btn.ghost{background:#f4f4f4;border:0;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}

    /* Footer legal + social */
    footer{background:transparent;border-top:0;margin-top:24px}
    .legal{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;margin:10px 0 4px}
    .legal a{color:#223;text-decoration:none}
    .legal a:hover{color:#d12b4a}
    .socials{margin:14px 0 10px; display:flex; gap:14px; justify-content:center; position:relative; z-index:2}
    .socials img{display:block;width:28px;height:28px}
  </style>

  <!-- IMPORTANT: coÈ™ -->
  <script src="cart.js"></script>
</head>
<body>

  <div class="promo">â„ï¸ Reduceri de iarnÄƒ pÃ¢nÄƒ la <b>20%</b> â€¢ Livrare gratuitÄƒ de la <b>300 RON</b> ğŸ</div>

  <header class="header">
    <nav id="main-nav" aria-label="Navigare principalÄƒ">
      <a href="index.html">AcasÄƒ</a>
      <a href="produse.html"><strong>Produse</strong></a>
      <a href="despre.html">Despre</a>
      <a href="contact.html">Contact</a>
      <span class="spacer"></span>
      <a href="cos.html" class="cart-pill" aria-label="Vezi coÈ™ul">ğŸ›’ <span id="cart-count" class="badge">0</span></a>
    </nav>
  </header>

  <!-- zÄƒpadÄƒ -->
  <div class="snow"></div><div class="snow2"></div>

  <main class="wrap">
    <h1>Produsele noastre</h1>

    <!-- CÄƒutare cu sugestii -->
    <div class="search-wrap">
      <input id="search" class="search-input" type="search" placeholder="CautÄƒ un produsâ€¦ (ex: Ã®nger, coroniÈ›Äƒ, crin, dans)" autocomplete="off">
      <div id="suggest" class="suggest hidden"></div>
    </div>

    <!-- grilÄƒ (umplutÄƒ din JS) -->
    <section class="grid" id="prod-list"></section>
  </main>

  <!-- Footer -->
  <footer>
    <div class="socials">
      <a href="https://facebook.com/msa.handmade" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
        <img src="images/facebook.svg" alt="Facebook">
      </a>
      <a href="https://instagram.com/msa.handmade" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
        <img src="images/instagram.svg" alt="Instagram">
      </a>
    </div>
    <nav class="legal" aria-label="Linkuri legale">
      <a href="termeni.html">Termeni &amp; CondiÈ›ii</a>
      <span>Â·</span>
      <a href="confidentialitate.html">ConfidenÈ›ialitate</a>
      <span>Â·</span>
      <a href="cookies.html">Cookies</a>
      <span>Â·</span>
      <a href="retur.html">Retur</a>
    </nav>
    <div style="text-align:center;color:#666;font-size:14px;margin-bottom:18px">
      Â© <span id="year"></span> â€” MSA Handmade. Toate drepturile rezervate.
    </div>
  </footer>

  <!-- MODAL produs (un singur sistem) -->
  <div class="modal" id="prod-modal" aria-hidden="true" role="dialog" aria-label="Previzualizare produs">
    <div class="modal-card">
      <div class="modal-media"><img id="m-img" src="" alt=""></div>
      <div class="modal-body">
        <div class="modal-top">
          <div class="modal-title" id="m-title"></div>
          <button class="modal-close" id="m-close">Ãnchide âœ•</button>
        </div>
        <p id="m-desc" class="muted"></p>
        <p style="font-weight:800;margin:.6rem 0">PreÈ›: <span id="m-price"></span></p>
        <p id="m-specs" class="muted" style="margin:.4rem 0 1rem"></p>
        <button class="btn primary" id="m-add">AdaugÄƒ Ã®n coÈ™</button>
      </div>
    </div>
  </div>

  <!-- Script paginÄƒ (produse + modal + cÄƒutare) -->
  <script>
    // === DATE PRODUSE (exact cum le-ai avut) ===
    const PRODUCTS = [
      { id:'coronita1', name:'CoroniÈ›Äƒ CrÄƒciun â€“ roÈ™u & auriu', price:35, image:'images/coronita1.png',
        desc:'StrÄƒlucire caldÄƒ de sÄƒrbÄƒtoare: flori aurii È™i accente roÈ™ii ce transformÄƒ uÈ™a sau peretele Ã®ntr-un colÈ› de poveste.',
        specs:{ material:'mix decor + lumini pe baterii', size:'Ã˜ 30 cm', weight:'-', notes:'luminÄƒ alb cald' } },
      { id:'coronita2', name:'CoroniÈ›Äƒ CrÄƒciun â€“ albastru & argintiu', price:35, image:'images/coronita2.png',
        desc:'EleganÈ›Äƒ rece, iernaticÄƒ: nuanÈ›e de albastru È™i argintiu pentru un decor premium, gata sÄƒ lumineze serile de iarnÄƒ.',
        specs:{ material:'mix decor + lumini pe baterii', size:'Ã˜ 30 cm', weight:'-', notes:'baterii incluse' } },
      { id:'sarut', name:'SÄƒrut', price:33, image:'images/sarut.jpg',
        desc:'DouÄƒ inimi, aceeaÈ™i luminÄƒ â€“ o piesÄƒ cu suflet.',
        specs:{ material:'cearÄƒ', size:'15 cm', weight:'280 g', notes:'' } },
      { id:'ingeras', name:'ÃngeraÈ™', price:5, image:'images/ingeras.png',
        desc:'Mic protector al casei tale, turnat manual. Perfect pentru seturi drÄƒgÄƒlaÈ™e È™i cadouri cu suflet.',
        specs:{ material:'cearÄƒ', size:'7 Ã— 3 cm', weight:'~30 g', notes:'' } },
      { id:'floricele', name:'Floricele', price:5, image:'images/floricele.png',
        desc:'Floricele delicate din cearÄƒ â€” un accent vesel pentru orice aranjament.',
        specs:{ material:'cearÄƒ', size:'4 Ã— 3 cm', weight:'~25 g', notes:'' } },
      {   
        id: 'moscraciun',
        name: 'MoÈ™ CrÄƒciun decorativ',
        price: 19.99,
        image: 'images/moscraciun.jpg',
        desc: 'FigurinÄƒ MoÈ™ CrÄƒciun turnatÄƒ manual din cearÄƒ, perfectÄƒ pentru decorul de sÄƒrbÄƒtori. Adu magia CrÄƒciunului Ã®n casa ta cu aceastÄƒ piesÄƒ delicatÄƒ È™i luminoasÄƒ.',
        specs: {
        material: 'cearÄƒ',
        size: 'aprox. 10 cm',
        weight: '~90 g',
        notes: 'fabricat manual'
      }
      },
      { id:'family', name:'Family', price:11, image:'images/family.png',
        desc:'Simbol liniÈ™titor al armoniei: piesÄƒ lucratÄƒ din cearÄƒ, cu o prezenÈ›Äƒ caldÄƒ È™i blÃ¢ndÄƒ.',
        specs:{ material:'cearÄƒ', size:'9 Ã— 4 cm', weight:'~60 g', notes:'' } },
      {
        id:'ruga',
        name:'LumÃ¢nare â€RugÄƒâ€',
        price:24.99,
        image:'images/ruga.png',
        desc:'LumÃ¢nare decorativÄƒ cu mÃ¢ini Ã®n rugÄƒciune, turnatÄƒ manual din cearÄƒ de soia premium. Simbol al protecÈ›iei È™i liniÈ™tii sufleteÈ™ti, idealÄƒ ca decor sau cadou.',
        specs:'material: cearÄƒ de soia, dimensiune: 9Ã— 8 cm, greutate ~150 g, notes:"lumÃ¢nare turnatÄƒ manual, mici variaÈ›ii sunt posibile"'
        },
      { id:'isus', name:'Iisus', price:33, image:'images/isus.png',
        desc:'Detalii frumoase pentru un colÈ› de rugÄƒciune plin de pace.',
        specs:{ material:'cearÄƒ', size:'11 Ã— 7 cm', weight:'~300 g', notes:'' } },
      { id:'buchet', name:'Buchet', price:29, image:'images/buchet.jpg',
        desc:'Flori din cearÄƒ pe tijÄƒ â€” graÈ›ioase, elegante, uÈ™or de integrat Ã®n decor.',
        specs:{ material:'flori din cearÄƒ pe tijÄƒ', size:'H 20 cm, L 3.5 cm', weight:'~120 g', notes:'' } },
      { id:'crin', name:'Crin', price:33, image:'images/crin.jpg',
        desc:'FormÄƒ floralÄƒ ce aduce rafinament È™i calm Ã®n orice Ã®ncÄƒpere.',
        specs:{ material:'cearÄƒ', size:'9.5 Ã— 6.5 cm', weight:'~200 g', notes:'' } },
      { id:'dans', name:'Dans', price:33, image:'images/dans.jpg',
        desc:'Siluete Ã®n miÈ™care â€” o poveste de iubire surprinsÄƒ Ã®n cearÄƒ.',
        specs:{ material:'cearÄƒ', size:'10 Ã— 6.5 cm', weight:'~200 g', notes:'' } },
      { id:'flori', name:'Flori (suport ipsos)', price:33, image:'images/flori.jpg',
        desc:'LumÃ¢nare din cearÄƒ prezentatÄƒ pe suport de ipsos lucrat manual.',
        specs:{ material:'cearÄƒ + suport ipsos', size:'Ã˜ 7 Ã— 5 cm', weight:'cearÄƒ ~100 g', notes:'suport inclus' } },
      { id:'inger', name:'Ãnger', price:33, image:'images/inger.jpg',
        desc:'Un simbol al protecÈ›iei È™i al luminii.',
        specs:{ material:'cearÄƒ', size:'9.5 Ã— 4.5 cm', weight:'~150 g', notes:'' } },
      { id:'logodna', name:'LogodnÄƒ', price:33, image:'images/logodna.jpg',
        desc:'RomanticÄƒ È™i elegantÄƒ â€” pentru momente care meritÄƒ pÄƒstrate.',
        specs:{ material:'cearÄƒ', size:'H 9.5 cm, L 4 cm', weight:'~120 g', notes:'' } },
      { id:'floarea-soarelui', name:'Floarea-soarelui', price:33, image:'images/lumanare_floarea-soarelui.png',
        desc:'Soare mic pentru casÄƒ: floare din cearÄƒ Ã®ntr-o prezentare plÄƒcutÄƒ.',
        specs:{ material:'cearÄƒ + suport ipsos', size:'farfurie 10 Ã— 5 cm', weight:'cearÄƒ ~100 g', notes:'' } },
      {   
        id:'vazasilueta',
        name:'VazÄƒ SiluetÄƒ â€“ cu flori',
        price:14.99,
        image:'images/vazasilueta.png',
        desc:'VazÄƒ decorativÄƒ elegantÄƒ, turnatÄƒ manual din ipsos, completatÄƒ cu flori artificiale. Culoarea È™i modelul florilor vor fi alese aleatoriu.',
        specs:'material: ipsos, Ã®nÄƒlÈ›ime vazÄƒ ~15 cm, cu aranjament ~28â€“30 cm, greutate -100 g, notes:"flori artificiale â€“ culoare È™i model aleatorii"'
      },
      {
        id:'vazaoudragon',
        name:'VazÄƒ Dragon â€“ cu flori',
        price:14.99,
        image:'images/vazaoudragon.png',
        desc:'VazÄƒ decorativÄƒ texturatÄƒ, realizatÄƒ manual din ipsos. Include flori artificiale, iar culoarea È™i modelul acestora vor fi alese aleatoriu.',
        specs:'material: ipsos, Ã®nÄƒlÈ›ime vazÄƒ ~12 cm, cu aranjament ~22â€“25 cm, greutate ~220 g, notes:"flori artificiale â€“ culoare È™i model aleatorii"'
      },
      { id:'peisaj', name:'Peisaj', price:99, image:'images/peisaj.jpg',
        desc:'Peisaj turnat Ã®n cearÄƒ â€” texturi blÃ¢nde È™i luminÄƒ caldÄƒ.',
        specs:{ material:'cearÄƒ', size:'suport 25 Ã— 9 cm', weight:'~300 g', notes:'' } },
      { id:'peisajiarna', name:'Peisaj de iarnÄƒ', price:99, image:'images/peisajiarna.jpg',
        desc:'Farmecul iernii surprins Ã®n cearÄƒ.',
        specs:{ material:'cearÄƒ', size:'suport 25 Ã— 9 cm', weight:'~300 g', notes:'' } },
      { id:'indragostiti', name:'ÃndrÄƒgostiÈ›i', price:99, image:'images/indragostiti.jpg',
        desc:'DouÄƒ inimi, aceeaÈ™i luminÄƒ â€” o piesÄƒ cu suflet.',
        specs:{ material:'cearÄƒ', size:'Ã˜ 15 cm', weight:'~280 g', notes:'' } },
    ];

    const mount = document.getElementById('prod-list');

    function card(p){
      return `
        <article class="card">
          <img class="thumb" src="${p.image}" alt="${p.name}" data-id="${p.id}" />
          <div class="body">
            <div class="top">
              <h3>${p.name}</h3>
              <span class="price">${p.price} RON</span>
            </div>
            <p class="desc">${p.desc||''}</p>
            <button class="btn primary add" data-id="${p.id}">AdaugÄƒ Ã®n coÈ™</button>
          </div>
        </article>
      `;
    }

    function render(products){ mount.innerHTML = products.map(card).join(''); bindCardEvents(); }

    // Sugestii
    const q = document.getElementById('search');
    const suggest = document.getElementById('suggest');

    function buildSuggestions(list){
      if (!q.value.trim()){ suggest.classList.add('hidden'); suggest.innerHTML=''; return; }
      const html = list.map(p => `<div class="suggest-item" data-id="${p.id}">${p.name}</div>`).join('');
      suggest.innerHTML = html || `<div class="suggest-item" data-id="">Nicio potrivire</div>`;
      suggest.classList.remove('hidden');
    }

    q.addEventListener('input', ()=>{
      const v = q.value.trim().toLowerCase();
      if (v.length < 2){ buildSuggestions([]); return; }
      const hits = PRODUCTS.filter(p =>
        p.name.toLowerCase().includes(v) ||
        (p.desc && p.desc.toLowerCase().includes(v))
      ).slice(0,8);
      buildSuggestions(hits);
    });

    document.addEventListener('click', (e)=>{
      if (e.target.classList.contains('suggest-item')){
        const id = e.target.dataset.id;
        suggest.classList.add('hidden');
        if (!id) return;
        const found = PRODUCTS.find(p => p.id === id);
        if (found){ render([found]); }
        q.blur();
      }else{
        if (!e.target.closest('.search-wrap')) suggest.classList.add('hidden');
      }
    });

    // Modal
    const modal = document.getElementById('prod-modal');
    const mImg  = document.getElementById('m-img');
    const mTitle= document.getElementById('m-title');
    const mDesc = document.getElementById('m-desc');
    const mPrice= document.getElementById('m-price');
    const mSpecs= document.getElementById('m-specs');
    const mAdd  = document.getElementById('m-add');
    const mClose= document.getElementById('m-close');
    let currentProd = null;

    function openModal(prod){
      currentProd = prod;
      mImg.src = prod.image; mImg.alt = prod.name;
      mTitle.textContent = prod.name;
      mDesc.textContent = prod.desc || '';
      mPrice.textContent = `${Number(prod.price).toFixed(2)} RON`;
      const s = prod.specs || {};
      mSpecs.textContent = [
        s.material ? `Material: ${s.material}` : '',
        s.size ? `Dimensiuni: ${s.size}` : '',
        s.weight ? `Greutate: ${s.weight}` : '',
        s.notes ? `Note: ${s.notes}` : ''
      ].filter(Boolean).join(' â€¢ ');
      modal.classList.add('open');
    }
    function closeModal(){ modal.classList.remove('open'); currentProd=null; }

    function addCurrentToCart(){
      if (!currentProd) return;
      if (window.MSACart && typeof MSACart.addToCart==='function'){
        MSACart.addToCart({ id:currentProd.id, name:currentProd.name, price:currentProd.price, image:currentProd.image });
      }else{
        // fallback simplu Ã®n localStorage (MSA_CART)
        const raw = localStorage.getItem('MSA_CART');
        const list = raw ? JSON.parse(raw) : [];
        const idx = list.findIndex(x=>x.id===currentProd.id);
        if (idx>=0) list[idx].qty=(list[idx].qty||1)+1; else list.push({id:currentProd.id,name:currentProd.name,price:currentProd.price,image:currentProd.image,qty:1});
        localStorage.setItem('MSA_CART', JSON.stringify(list));
      }
      updateBadge();
      closeModal();
    }

    mAdd.addEventListener('click', addCurrentToCart);
    mClose.addEventListener('click', closeModal);
    modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });

    function bindCardEvents(){
      document.querySelectorAll('.thumb').forEach(img=>{
        img.addEventListener('click', ()=>{
          const id = img.dataset.id;
          const p = PRODUCTS.find(x=>x.id===id);
          if (p) openModal(p);
        });
      });
      document.querySelectorAll('.add').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.dataset.id;
          const p = PRODUCTS.find(x=>x.id===id);
          if (!p) return;
          if (window.MSACart && typeof MSACart.addToCart==='function'){
            MSACart.addToCart({ id:p.id, name:p.name, price:p.price, image:p.image });
          }else{
            const raw = localStorage.getItem('MSA_CART');
            const list = raw ? JSON.parse(raw) : [];
            const idx = list.findIndex(x=>x.id===p.id);
            if (idx>=0) list[idx].qty=(list[idx].qty||1)+1; else list.push({id:p.id,name:p.name,price:p.price,image:p.image,qty:1});
            localStorage.setItem('MSA_CART', JSON.stringify(list));
          }
          updateBadge();
          const old = btn.textContent; btn.textContent='AdÄƒugat!'; setTimeout(()=>btn.textContent=old,800);
        });
      });
    }

    // Badge coÈ™ sincronizat
    function updateBadge(){
      try{
        if (window.MSACart?.updateCartCountBadge){ MSACart.updateCartCountBadge(); return; }
        const raw = localStorage.getItem('MSA_CART');
        const items = raw ? JSON.parse(raw) : [];
        const count = Array.isArray(items) ? items.reduce((s,it)=>s+(Number(it.qty)||1),0) : 0;
        const el = document.getElementById('cart-count'); if (el) el.textContent = count;
      }catch(_){}
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      render(PRODUCTS);
      const y = document.getElementById('year'); if (y) y.textContent = new Date().getFullYear();
      updateBadge();
      window.addEventListener('storage', (e)=>{ if(e.key==='MSA_CART') updateBadge(); });
    });
  </script>

  <!-- DacÄƒ ai È™i alte scripturi proprii -->
  <script src="script.js"></script><script>
/* Stop dublare la â€œAdaugÄƒ Ã®n coÈ™â€ â€“ un singur handler global */
(function(){
  const KEY = 'MSA_CART';

  function read(){ try{ return JSON.parse(localStorage.getItem(KEY))||[] }catch(_){ return [] } }
  function write(items){
    localStorage.setItem(KEY, JSON.stringify(items));
    try{
      const c = items.reduce((s,i)=>s+(+i.qty||0),0);
      const el = document.getElementById('cart-count');
      if (el) el.textContent = c;
    }catch(_){}
    // ping cÄƒtre celelalte pagini (badge)
    window.dispatchEvent(new StorageEvent('storage', {key: KEY, newValue: localStorage.getItem(KEY)}));
  }

  function add(item){
    const cart = read();
    const i = cart.findIndex(p => String(p.id) === String(item.id));
    if (i > -1) cart[i].qty = (Number(cart[i].qty)||0) + (Number(item.qty)||1);
    else cart.push({ id:item.id, name:item.name, price:Number(item.price)||0, image:item.image||'', qty:Number(item.qty)||1 });
    write(cart);
  }

  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('.add-to-cart,[data-add-to-cart]');
    if (!btn) return;

    // anti-dublu-trigger
    if (btn.dataset.busy === '1') return;
    btn.dataset.busy = '1'; setTimeout(()=>btn.dataset.busy='0', 350);

    const d = btn.dataset;
    if (!d.id || !d.name || !d.price) { alert('Butonul nu are data-id/name/price.'); return; }

    add({ id:d.id, name:d.name, price:d.price, image:d.image||'', qty:d.qty||1 });

    // feedback mic
    const old = btn.textContent;
    btn.textContent = 'AdÄƒugat âœ“';
    setTimeout(()=> btn.textContent = old, 600);
  });
})();
</script>
</body>
</html>
