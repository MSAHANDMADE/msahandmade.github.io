<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coș – MSA Handmade Decor</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<header class="site-header">
  <a class="brand" href="index.html"><img src="logo.png" alt="MSA Handmade Decor" class="brand-logo"></a>
  <nav class="nav-links">
    <a href="index.html">Acasă</a>
    <a href="produse.html">Produse</a>
    <a href="contact.html">Contact</a>
    <a href="cos.html" class="cart-link">Coș (<span id="cart-count">0</span>)</a>
  </nav>
</header>

<main class="container">
  <h1 class="page-title">Coșul tău</h1>

  <!-- Lista produse din coș -->
  <div id="cart-root" class="cart-root"></div>

  <!-- Formular livrare -->
  <h2 style="margin-top:24px">Date livrare (plata la livrare)</h2>
  <form class="order-form" onsubmit="return placeOrderViaEmail(this)">
    <div class="radio-group">
      <label><input type="radio" name="tip" value="pf" checked onclick="togglePJ(false)"> Persoană fizică</label>
      <label><input type="radio" name="tip" value="pj" onclick="togglePJ(true)"> Persoană juridică</label>
    </div>

    <div class="form-row">
      <label>Nume
        <input name="nume" required>
      </label>
      <label>Prenume
        <input name="prenume" required>
      </label>
    </div>

    <div class="form-row">
      <label>Email (pentru confirmare)
        <input name="email" type="email" placeholder="ex: nume@email.com">
      </label>
      <label>Telefon
        <input name="telefon" required placeholder="07xx xxx xxx">
      </label>
    </div>

    <div class="form-row">
      <label>Județ
        <input name="judet" required>
      </label>
      <label>Oraș
        <input name="oras" required>
      </label>
    </div>

    <div class="form-row">
      <label>Cod poștal
        <input name="cod_postal">
      </label>
      <label>Adresă
        <input name="adresa" required placeholder="Str., Nr., Bl., Sc., Ap.">
      </label>
    </div>

    <!-- Câmpuri PJ (se arată doar când e bifat PJ) -->
    <div id="pj-fields" style="display:none">
      <div class="form-row">
        <label>Denumire firmă
          <input name="firma">
        </label>
        <label>CUI
          <input name="cui">
        </label>
      </div>
    </div>

    <label>Mentiuni (optional)
      <textarea name="mentiuni" placeholder="Culoare/variantă dorită, interval livrare, etc."></textarea>
    </label>

    <div class="form-row" style="justify-content:flex-start;gap:12px">
      <button type="submit" class="btn-primary">Trimite comanda</button>
      <button type="button" class="btn-ghost" onclick="clearCart()">Golește coșul</button>
    </div>
  </form>
</main>

<footer class="site-footer">
  <span id="y"></span> © M.S.A Handmade Decor — Toate drepturile rezervate.
</footer>

<script src="cart.js"></script>
<script>
// anul din footer
document.getElementById('y').textContent = new Date().getFullYear();

// afișare/ascundere câmpuri PJ
function togglePJ(show){
  document.getElementById('pj-fields').style.display = show ? '' : 'none';
}

// Render coș în pagina curentă
window.renderCart = function renderCart(){
  const root = document.getElementById('cart-root');
  const cart = getCart();

  if (!cart.length) {
    root.innerHTML = '<p>Coșul este gol.</p>';
    return;
  }

  const rows = cart.map(p => `
    <div class="cart-row">
      <div class="cart-info">
        <div class="cart-title">${p.name}</div>
        <div class="cart-price">${(p.price).toFixed(2)} RON / buc</div>
      </div>

      <div class="cart-qty">
        <button type="button" class="qty-btn" onclick="changeQty(${p.id}, -1)">−</button>
        <span>${p.qty}</span>
        <button type="button" class="qty-btn" onclick="changeQty(${p.id}, 1)">+</button>
      </div>

      <div class="cart-subtotal">${(p.price * p.qty).toFixed(2)} RON</div>
      <button type="button" class="remove-btn" onclick="removeItem(${p.id})">Șterge</button>
    </div>
  `).join('');

  const subtotal = cart.reduce((s,p)=> s + p.price * p.qty, 0);
  const livrare  = 17;
  const total    = subtotal + livrare;

  root.innerHTML = `
    <div class="cart-list">${rows}</div>
    <div class="cart-total">
      <div>Subtotal: <strong>${subtotal.toFixed(2)} RON</strong></div>
      <div>Livrare: <strong>${livrare.toFixed(2)} RON</strong></div>
      <div style="font-size:18px;margin-top:6px">Total: <strong>${total.toFixed(2)} RON</strong></div>
    </div>
  `;
};

// init
togglePJ(false);
renderCart();
</script>
</body>
</html>
