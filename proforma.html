<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proformă — MSA Handmade</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 40px auto;
      padding: 20px;
      max-width: 900px;
      background: #fff;
      color: #222;
    }
    h1 {
      text-align: center;
      font-size: 28px;
      margin-bottom: 10px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      border-bottom: 2px solid #ddd;
      padding-bottom: 10px;
      margin-bottom: 15px;
    }
    .col {
      width: 32%;
      font-size: 13px;
      line-height: 1.4;
    }
    .center {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
    }
    th {
      background: #fafafa;
      text-align: left;
    }
    td:last-child, th:last-child {
      text-align: right;
    }
    .totals {
      width: 280px;
      float: right;
      margin-top: 20px;
      border: 1px solid #ddd;
    }
    .totals td {
      border: 1px solid #ddd;
      padding: 6px 10px;
    }
    .totals td:first-child {
      text-align: left;
      background: #fafafa;
      width: 50%;
    }
    .totals td:last-child {
      text-align: right;
      font-weight: 600;
    }
    .footer {
      clear: both;
      margin-top: 40px;
      font-size: 12px;
      color: #666;
      border-top: 1px solid #ddd;
      padding-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body>

  <h1>PROFORMĂ</h1>

  <div class="header">
    <!-- STÂNGA: VANZATOR -->
    <div class="col">
      <strong>VÂNZĂTOR</strong><br>
      STOICA MIHAELA – PERSOANĂ FIZICĂ AUTORIZATĂ<br>
      CUI: 52191623<br>
      Nr. Reg. Comerț: F40/5433/2024<br>
      EUID: ROF40PFA5433040<br>
      Sediu: Jud. Ilfov, Oraș Bragadiru,<br>
      Str. Generalului, Nr. 10, Cam. 1, Bl. 1, Ap. 2<br>
      Neplătitor de TVA<br>
      Tel: 07xx xxx xxx<br>
      Email: msahandmade.contact@gmail.com
    </div>

    <!-- MIJLOC: INFO PROFORMĂ -->
    <div class="col center">
      <h2 style="margin:0;font-size:18px;">PROFORMĂ</h2>
      <strong>Nr. comandă:</strong> <span id="nrcom"></span><br>
      <strong>Data:</strong> <span id="datacom"></span>
    </div>

    <!-- DREAPTA: CLIENT -->
    <div class="col" id="client-info" style="text-align:right">
      <strong>CLIENT</strong><br>
      <span id="client-nume"></span><br>
      <span id="client-adresa"></span><br>
      <span id="client-email"></span>
    </div>
  </div>

  <table id="tabel-produse">
    <thead>
      <tr>
        <th>Produs</th>
        <th>Cant.</th>
        <th>Preț</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      <tr><td colspan="4" style="text-align:center;color:#777;">Nu sunt produse adăugate.</td></tr>
    </tbody>
  </table>

  <table class="totals">
    <tr><td>Subtotal</td><td id="subtotal">0.00 RON</td></tr>
    <tr><td>Reducere</td><td id="reducere">0.00 RON</td></tr>
    <tr><td>Livrare</td><td id="livrare">0.00 RON</td></tr>
    <tr><td><strong>Total</strong></td><td id="total"><strong>0.00 RON</strong></td></tr>
  </table>

  <div class="footer">
    Această proformă a fost generată automat. Vă mulțumim pentru comanda dumneavoastră!<br>
    MSA Handmade — Lumânări și decorațiuni artizanale.
  </div>

  <script>
    // Se preiau din localStorage datele ultimei comenzi (dacă sunt)
    const order = JSON.parse(localStorage.getItem('MSA_LAST_ORDER') || '{}');
    const { items = [], totaluri = {}, client = {}, orderId = '' } = order;

    // Umple informațiile
    document.getElementById('nrcom').textContent = orderId || '-';
    document.getElementById('datacom').textContent = new Date().toLocaleDateString('ro-RO');
    document.getElementById('client-nume').textContent = client.nume || client.denumire || '-';
    document.getElementById('client-adresa').textContent =
      (client.adresa ? client.adresa + ', ' : '') + (client.oras || '') + (client.judet ? ', ' + client.judet : '');
    document.getElementById('client-email').textContent = client.email || '';

    // Formatează RON
    const fmt = n => (Number(n) || 0).toFixed(2) + ' RON';

    // Tabel produse
    const tbody = document.querySelector('#tabel-produse tbody');
    if (items.length) {
      tbody.innerHTML = items.map(it => `
        <tr>
          <td>${it.name}</td>
          <td style="text-align:center">${it.qty}</td>
          <td style="text-align:right">${fmt(it.price)}</td>
          <td style="text-align:right">${fmt(it.price * it.qty)}</td>
        </tr>
      `).join('');
    }

    // Totaluri
    document.getElementById('subtotal').textContent = fmt(totaluri.subtotal || 0);
    document.getElementById('reducere').textContent = fmt(totaluri.reducere || 0);
    document.getElementById('livrare').textContent = fmt(totaluri.livrare || 0);
    document.getElementById('total').textContent = fmt(totaluri.total || 0);
  </script>
</body>
</html>
